CREATE VIEW `view_t_stats` AS select `t`.`trxtime` AS `trxtime`,`t`.`agentid` AS `agentid`,`t`.`siteid` AS `siteid`,`t`.`typeid` AS `typeid`,`t`.`raws` AS `raws`,`t`.`uniques` AS `uniques`,`t`.`chargebacks` AS `chargebacks`,`t`.`signups` AS `signups`,`t`.`frauds` AS `frauds`,`t`.`sales_type1` AS `sales_type1`,`t`.`sales_type2` AS `sales_type2`,`t`.`sales_type3` AS `sales_type3`,`t`.`sales_type4` AS `sales_type4`,`t`.`run_id` AS `run_id`,`t`.`group_by` AS `group_by`,`b`.`companyid` AS `companyid`,`c`.`officename` AS `officename`,`a`.`username` AS `username`,`a`.`username4m` AS `username4m`,`b`.`ag1stname` AS `ag1stname`,`b`.`aglastname` AS `aglastname`,`s`.`sitename` AS `sitename`,`p`.`typename` AS `typename`,((((`t`.`sales_type1` + `t`.`sales_type2`) + `t`.`sales_type3`) + `t`.`sales_type4`) - `t`.`chargebacks`) AS `net`,(((((`t`.`sales_type1` + `t`.`sales_type2`) + `t`.`sales_type3`) + `t`.`sales_type4`) - `t`.`chargebacks`) * `h`.`ownprice`) AS `payouts`,(((((`t`.`sales_type1` + `t`.`sales_type2`) + `t`.`sales_type3`) + `t`.`sales_type4`) - `t`.`chargebacks`) * `f`.`earning`) AS `earnings` from (((((((`t_stats` `t` join `accounts` `a`) join `agents` `b`) join `companies` `c`) join `sites` `s`) join `types` `p`) join `fees` `f`) join `tmp_com_fees` `h`) where ((`t`.`agentid` = `a`.`id`) and (`a`.`id` = `b`.`id`) and (`b`.`companyid` = `c`.`id`) and (`t`.`siteid` = `s`.`id`) and (`t`.`typeid` = `p`.`id`) and (`p`.`id` = `f`.`typeid`) and (`f`.`id` = `h`.`feeid`) and (`h`.`companyid` = `c`.`id`) and (`t`.`trxtime` >= `f`.`start`) and (`t`.`trxtime` <= `f`.`end`));